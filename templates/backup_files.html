{% extends 'base.html' %}
{% block content %}
<h3>Backup Files</h3>

{% if not date_folders %}
  <div class="alert alert-info">No backups found yet.</div>
{% endif %}

<div class="accordion" id="backupAccordion">
  {% for group in date_folders %}
  <div class="accordion-item">
    <h2 class="accordion-header" id="heading{{ loop.index }}">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}">
        {{ group.date }}
      </button>
    </h2>
    <div id="collapse{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent="#backupAccordion">
      <div class="accordion-body">
        {% if group.files %}
        <ul class="list-group">
          {% for f in group.files %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span>{{ f }}</span>
            <div class="d-flex gap-2">
              <a class="btn btn-sm btn-outline-primary" href="{{ url_for('download_backup', date=group.date, filename=f) }}">Download</a>
              <form method="post" action="{{ url_for('delete_backup_file', date=group.date, filename=f) }}" onsubmit="return confirm('Delete backup {{ f }}?');">
                <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
              </form>
            </div>
          </li>
          {% endfor %}
        </ul>
        {% else %}
          <span class="text-muted">No .backup files.</span>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}


